almost certainly segfaults on bad input

when generaldelta is true, debugindex writes 'delta' instead of 'base'
and has -1 when the baserev is equal to the current revno

might need to understand the behavior with 32 bit pointers
what are mercurial's file size limits?
omg stop casting between all the different integer types

actually scan the delta chain to produce the full text
